@model List<IPTSYSTEM.Models.Listing>
@{
 ViewData["Title"] = "My Listings";
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/mylistings.css" asp-append-version="true" />
}

<!-- My Listings Page - Modern Minimalist Design -->
<section class="my-listings-page">
  <div class="container py-5">
        <!-- Page Header - Clean & Simple -->
        <div class="page-header mb-5">
         <div class="d-flex justify-content-between align-items-center">
             <div>
            <h1 class="page-title">My Listings</h1>
  <p class="page-subtitle">Manage your products</p>
       </div>
                <button class="btn-add-new" onclick="openListingModal()">
             <i class="bi bi-plus-circle me-2"></i>
   Add New Listing
        </button>
            </div>
    </div>

        <!-- Listings Grid - Minimalist Cards -->
        <div class="listings-grid" id="listings-container">
            @if (Model != null && Model.Any())
            {
     @foreach (var listing in Model)
         {
     <div class="listing-card-minimal" 
  id="listing-@listing.Id"
           data-category="@listing.Category"
  data-condition="@listing.Condition"
 data-price="@listing.Price"
    data-title="@listing.Title">
           
   <!-- Product Image -->
               <div class="product-image-wrapper">
              <img src="@listing.ImageUrl" 
  alt="@listing.Title" 
 class="product-image"
        onerror="this.src='https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500&h=500&fit=crop'">
         
     <!-- Condition Badge -->
     <span class="condition-badge badge-@listing.Condition.Replace(" ", "-").ToLower()">
    @listing.Condition
   </span>
  </div>

         <!-- Product Info -->
  <div class="product-info">
        <h3 class="product-title">@listing.Title</h3>
    <p class="product-description">@listing.Description</p>
          
    <!-- Price & Category -->
       <div class="product-meta">
        <span class="product-price">$@listing.Price</span>
            <span class="product-category">@listing.Category</span>
      </div>

           <!-- Action Buttons -->
          <div class="product-actions">
 <button class="btn-action btn-edit-minimal" 
                 onclick="editListing(@listing.Id)"
          title="Edit">
             <i class="bi bi-pencil"></i>
     Edit
     </button>
                <button class="btn-action btn-delete-minimal" 
     onclick="deleteListing(@listing.Id, '@listing.Title')"
       title="Delete">
     <i class="bi bi-trash"></i>
         </button>
         </div>
         </div>
 </div>
      }
     }
            else
            {
   <!-- Empty State -->
       <div class="empty-state-minimal">
        <i class="bi bi-inbox"></i>
         <h3>No listings yet</h3>
   <p>Create your first listing to get started!</p>
      <button class="btn-add-new" onclick="openListingModal()">
             <i class="bi bi-plus-circle me-2"></i>
                Add Your First Listing
        </button>
    </div>
      }
        </div>
    </div>
</section>

<!-- Add/Edit Listing Modal -->
<div class="modal fade" id="listingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content modern-modal">
            <div class="modal-header border-0">
                <div>
       <h2 class="modal-title" id="modalTitle">Add New Listing</h2>
    <p class="modal-subtitle">Fill in the details below</p>
   </div>
      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>
          <div class="modal-body">
   <form id="listingForm">
   <input type="hidden" id="listingId" value="0">
    <input type="hidden" id="imageUrl" value="">
    
       <!-- Image Upload Section -->
      <div class="mb-4">
      <label class="form-label">Product Photo *</label>
   
             <!-- Image Preview Box -->
       <div class="image-upload-container" id="imageUploadContainer">
   <div class="image-preview-area" id="imagePreviewArea">
                  <img id="imagePreview" src="" alt="Preview" style="display: none;">
       <div class="upload-placeholder" id="uploadPlaceholder">
    <i class="bi bi-cloud-upload" style="font-size: 3rem; color: #9ca3af;"></i>
     <p class="mt-3 mb-2" style="font-weight: 600; color: #1a1a1a;">Click to upload or drag and drop</p>
  <p class="text-muted" style="font-size: 0.875rem;">PNG, JPG, GIF up to 10MB</p>
      </div>
     </div>
       
       <!-- Hidden File Input -->
         <input type="file" 
            id="imageFileInput" 
             accept="image/*" 
      style="display: none;">
     
          <!-- Remove Button -->
         <button type="button" 
      class="btn-remove-image" 
   id="removeImageBtn" 
                   style="display: none;"
     onclick="removeImage()">
    <i class="bi bi-x-circle"></i>
 </button>
    </div>
   
         <!-- Alternative: Paste URL -->
    <div class="mt-3">
                  <div class="d-flex align-items-center mb-2">
           <hr class="flex-grow-1">
           <span class="px-3 text-muted" style="font-size: 0.875rem;">or paste image URL</span>
        <hr class="flex-grow-1">
       </div>
                    <input type="url" 
        class="form-control minimal-input" 
          id="imageUrlInput" 
          placeholder="https://example.com/image.jpg">
         </div>
      </div>

  <!-- Title -->
    <div class="mb-4">
    <label for="title" class="form-label">Title *</label>
<input type="text" 
 class="form-control minimal-input" 
 id="title" 
 placeholder="e.g., iPhone 13 Pro Max 256GB" 
        required
       maxlength="100">
  </div>

       <!-- Description -->
     <div class="mb-4">
    <label for="description" class="form-label">Description *</label>
    <textarea class="form-control minimal-input" 
     id="description" 
          rows="3" 
         placeholder="Describe your item..." 
 required
    maxlength="500"></textarea>
     </div>

            <div class="row g-3">
          <!-- Price -->
 <div class="col-md-6">
      <label for="price" class="form-label">Price ($) *</label>
      <input type="number" 
 class="form-control minimal-input" 
    id="price" 
     placeholder="0.00" 
        step="0.01" 
     min="0" 
      required>
  </div>

<!-- Category -->
 <div class="col-md-6">
          <label for="category" class="form-label">Category *</label>
         <select class="form-select minimal-input" id="category" required>
    <option value="">Select category</option>
     <option value="Electronics">Electronics</option>
     <option value="Fashion">Fashion</option>
     <option value="Home & Living">Home & Living</option>
<option value="Books">Books</option>
       <option value="Sports">Sports</option>
  <option value="Furniture">Furniture</option>
      </select>
   </div>
</div>

 <!-- Condition -->
   <div class="mt-4">
     <label class="form-label">Condition *</label>
          <div class="condition-options">
             <input type="radio" class="btn-check" name="condition" id="conditionNew" value="New">
     <label class="condition-option" for="conditionNew">New</label>

       <input type="radio" class="btn-check" name="condition" id="conditionLikeNew" value="Like New">
       <label class="condition-option" for="conditionLikeNew">Like New</label>

       <input type="radio" class="btn-check" name="condition" id="conditionGood" value="Good">
  <label class="condition-option" for="conditionGood">Good</label>

      <input type="radio" class="btn-check" name="condition" id="conditionFair" value="Fair">
           <label class="condition-option" for="conditionFair">Fair</label>
         </div>
  </div>
  </form>
   </div>
          <div class="modal-footer border-0">
         <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">Cancel</button>
    <button type="button" class="btn-modal-save" onclick="saveListing()">
        <span id="saveButtonText">Save Listing</span>
    </button>
    </div>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11000">
    <div id="toastNotification" class="toast" role="alert">
<div class="d-flex">
    <div class="toast-body" id="toastMessage"></div>
            <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/listings-manager.js"></script>
    <script src="~/js/listings-enhanced.js"></script>
}
